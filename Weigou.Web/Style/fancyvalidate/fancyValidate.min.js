/*! Fancy Validate v0.1.9 | Copyright 2013 cormin.lu@gmail.com | MIT Licensed | Build 09/22/2013 */
(function(e,t){function m(e){this.event=e,this.type=e.type,this.target=e.target||e.srcElement}function g(){this.list=[]}function y(e){d.error("not implemented")}function b(e){if(!(this instanceof b))return new b(e);this.init(e)}function w(e,t){if(!(this instanceof w))return new w(e,t);this.form=v.get(e),this.form||d.error("form not found"),this.init(t),d.extend(!0,this.settings,w.defaults,t),this.initForm()}var n=e.document,r=/\S/,i=/^[\s\xA0]+/,s=/[\s\xA0]+$/,o=/\{(\d+)\}/,u={},a=Object.prototype.toString,f=Object.prototype.hasOwnProperty,l=Array.prototype.slice,c=Array.prototype.indexOf,h=String.prototype.trim,p=function(){var e={},t="Boolean Number String Function Array Date RegExp Object".split(" "),n=0,r=t.length;for(;n<r;)e["[object "+t[n]+"]"]=t[n++].toLowerCase();return e}(),d={trim:h?function(e){return e==null?"":h.call(e)}:function(e){return e==null?"":e.toString().replace(i,"").replace(s,"")},startsWith:function(e,t){return e.slice(0,t.length)==t},endsWith:function(e,t){return e.slice(-t.length)==t},makeArray:function(e){return l.call(e,0)},inArray:c?function(e,t,n){return c.call(e,t,n)}:function(e,t,n){var r=e.length;n=n?n<0?Math.max(0,r+n):n:0;for(;n<r;n++)if(n in e&&e[n]===t)return n;return-1},remove:function(e,t){return t>-1&&e.splice(t,1)},format:function(e,t){return arguments.length==1?function(){var t=d.makeArray(arguments);return t.unshift(e),d.format.apply(this,t)}:(arguments.length>2&&!d.isArray(t)&&(t=d.makeArray(arguments).slice(1)),d.isArray(t)||(t=[t]),d.each(t,function(t,n){e=e.replace(u[n]||(u[n]=new RegExp("\\{"+n+"\\}","g")),t)}),e)},hasFormat:function(e){return o.test(e)},parse:function(e){return!d.isString(e)||d.isEmpty(e)?null:(e=d.trim(e),(new Function("return "+e))())},each:function(e,n,r){var i,s=0,o=e.length,u=o===t;if(u){for(i in e)if(n.call(r||e[i],e[i],i)===!1)break}else for(;s<o;)if(n.call(r||e[s],e[s],s++)===!1)break;return e},getType:function(e){return e==null?String(e):p[a.call(e)]||"object"},isType:function(e,t){return d.getType(e)===t},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},isDigit:function(e){return d.isNumeric(e)&&e%1==0},isDate:function(e){return d.isType(e,"date")&&!isNaN(e)},isEmpty:function(e){return!r.test(e)},isEmptyObject:function(e){for(var t in e)return!1;return!0},isPlainObject:function(e){if(!e||!d.isObject(e)||e.nodeType)return!1;try{if(e.constructor&&!f.call(e,"constructor")&&!f.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}var r;for(r in e);return r===t||f.call(e,r)},extend:function(){var e,n,r,i,s,o,u=arguments[0]||{},a=1,f=arguments.length,l=!1;typeof u=="boolean"&&(l=u,u=arguments[1]||{},a=2),typeof u!="object"&&!d.isFunction(u)&&(u={});for(;a<f;a++)if((e=arguments[a])!=null)for(n in e){r=u[n],i=e[n];if(u===i)continue;l&&i&&(d.isPlainObject(i)||(s=d.isArray(i)))?(s?(s=!1,o=r&&d.isArray(r)?r:[]):o=r&&d.isPlainObject(r)?r:{},u[n]=d.extend(l,o,i)):i!==t&&(u[n]=i)}return u},error:function(e){var t=d.isObject(e)?e:new Error(e);throw t}};d.each("Boolean String Function Array RegExp Object".split(" "),function(e){d["is"+e]=function(t){return d.isType(t,e.toLowerCase())}});var v={ready:function(t){/in/.test(n.readyState)?e.setTimeout(function(){v.ready(t)},10):t()},get:function(e){return v.isElement(e)?e:n.getElementById(e)},isElement:function(e){return e&&e.nodeType===1},attr:function(e,n,r){if(v.isElement(e)){if(r===t)return e[n]||e.getAttribute(n);e.setAttribute(n,r)}return null},addClass:function(e,t){if(v.isElement(e)&&t)if(!e.className)e.className=t;else{var n=t.split(" ");n.length>1?d.each(n,function(t){v.addClass(e,t)}):d.inArray(e.className.split(" "),t)==-1&&(e.className+=" "+t)}},removeClass:function(e,t){if(v.isElement(e)&&e.className&&t){var n=e.className.split(" "),r=t.split(" ");r.length>1?d.each(r,function(t){v.removeClass(e,t)}):d.remove(n,d.inArray(n,t))&&(e.className=n.join(" "))}},toggle:function(e,t){e.style.display=t?"":"none"},remove:function(e){e&&e.parentNode&&e.parentNode.removeChild(e)},offset:function(e){var t=0,n=0;do t+=e.offsetTop,n+=e.offsetLeft;while(e=e.offsetParent);return{top:t,left:n}},setRange:function(e,t,n){if(e.setSelectionRange)e.focus(),e.setSelectionRange(t,n);else if(e.createTextRange){var r=e.createTextRange();r.collapse(!0),r.moveEnd("character",n),r.moveStart("character",t),r.select()}},getRange:function(e){var t,r,i,s,o,u=e.value;return e.setSelectionRange?(t=e.selectionStart,r=e.selectionEnd):e.createTextRange&&(i=n.selection.createRange(),s=i.duplicate(),v.istextarea(e)?(s.moveToElementText(e),s.setEndPoint("EndToEnd",i),o=i.text.length,t=s.text.length-o,r=t+o):(o=u.length,s.moveEnd("character",o),t=s.text==""?o:u.lastIndexOf(s.text),s=i.duplicate(),s.moveStart("character",-o),r=s.text.length)),{start:t,end:r,text:u.substring(t,r),replace:function(n){return e.value.substring(0,t)+n+e.value.substring(r,e.value.length)}}},getRange2:function(e){var t,r,i;return e.setSelectionRange?(t=e.selectionStart,r=e.selectionEnd):(i=n.selection.createRange(),t=0-i.duplicate().moveStart("character",-1e5),r=t+i.text.length),{start:t,end:r,text:e.value.substring(t,r),replace:function(n){return e.value.substring(0,t)+n+e.value.substring(r,e.value.length)}}},focus:function(e){e.istext===t&&(e.istext=v.istextarea(e)||v.isItext(e));try{e.istext&&e.value?v.setRange(e,0,e.value.length):e.focus&&e.focus()}catch(n){}},log:function(){e.console&&console.log(d.makeArray(arguments).join(" "))}};d.each("radio checkbox text".split(" "),function(e){v["isI"+e]=function(t){return v.isElement(t)&&t.nodeName.toLowerCase()==="input"&&t.type===e}}),d.each("input textarea select option label".split(" "),function(e){v["is"+e]=function(t){return v.isElement(t)&&t.nodeName.toLowerCase()===e}}),d.extend(m,{specials:{focusin:"focus",focusout:"blur"},add:n.addEventListener?function(e,t,n){var r=m.specials[t];e.addEventListener(r||t,n,!!r)}:function(t,n,r){n=="input"&&"onpropertychange"in t?t.onpropertychange=function(){e.event.propertyName=="value"&&r.call(this,e.event)}:t.attachEvent("on"+n,r)},remove:n.removeEventListener?function(e,t,n){var r=m.specials[t];e.removeEventListener(r||t,n,!!r)}:function(e,t,n){t=="input"&&"onpropertychange"in e?e.onpropertychange=null:e.detachEvent("on"+t,n)},fix:function(t){return new m(t||e.event)},prototype:{stopPropagation:function(){var e=this.event;e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0},preventDefault:function(){var e=this.event;e.preventDefault&&e.preventDefault(),e.returnValue=!1},stop:function(){this.preventDefault(),this.stopPropagation()}}}),d.extend(g.prototype,{first:function(){if(this.len())return this.list[0].key},len:function(){return this.list.length},each:function(e,t){d.each(this.list,e,t)},find:function(e){var t=-1;return this.each(function(n,r){if(n.key==e)return t=r,!1}),t},findEntry:function(e){var t=this.find(e);if(t>-1)return this.list[t]},remove:function(e){d.remove(this.list,this.find(e))},add:function(e,t){this.remove(e),this.list.push({key:e,message:t||""})},reset:function(){this.list.length=0}}),d.extend(b,{version:.1,build:new Date(13232736e5),core:d,dom:v,event:m,defaults:{rules:{},messages:{}},messages:{required:"\u6b64\u5b57\u6bb5\u662f\u5fc5\u9700\u7684",compareTo:"\u8bf7\u518d\u6b21\u8f93\u5165\u76f8\u540c\u7684\u503c",pattern:"\u8f93\u5165\u7684\u683c\u5f0f\u4e0d\u5339\u914d",fn:"\u8f93\u5165\u4e0d\u5339\u914d",minlength:d.format("\u8bf7\u8f93\u5165\u4e00\u4e2a\u957f\u5ea6\u6700\u5c11\u662f {0} \u7684\u5b57\u7b26\u4e32"),maxlength:d.format("\u8bf7\u8f93\u5165\u4e00\u4e2a\u957f\u5ea6\u6700\u591a\u662f {0} \u7684\u5b57\u7b26\u4e32"),rangelength:d.format("\u8bf7\u8f93\u5165\u4e00\u4e2a\u957f\u5ea6\u4ecb\u4e8e {0} \u548c {1} \u4e4b\u95f4\u7684\u5b57\u7b26\u4e32"),min:d.format("\u8bf7\u8f93\u5165\u4e00\u4e2a\u6700\u5c0f\u4e3a {0} \u7684\u503c"),max:d.format("\u8bf7\u8f93\u5165\u4e00\u4e2a\u6700\u5927\u4e3a {0} \u7684\u503c"),range:d.format("\u8bf7\u8f93\u5165\u4e00\u4e2a\u4ecb\u4e8e {0} \u548c {1} \u4e4b\u95f4\u7684\u503c"),digit:"\u8bf7\u53ea\u8f93\u5165\u6574\u6570",numeric:"\u8bf7\u8f93\u5165\u6709\u6548\u7684\u6570\u5b57",prefix:d.format("\u8bf7\u8f93\u5165\u4ee5 {0} \u5f00\u5934"),suffix:d.format("\u8bf7\u8f93\u5165\u4ee5 {0} \u7ed3\u5c3e"),equal:d.format("\u8bf7\u8f93\u5165\u4e0e {0} \u76f8\u7b49\u7684\u503c")},methods:{required:function(e,t){return this.getLen(e,t)>0},compareTo:function(e,t,n){var r=this.getElement(n);return r&&e==this.getValue(r)},pattern:function(e,t,n){var r=d.isRegExp(n)?n:new RegExp(n);return this.optional(t)||r.test(e)},fn:function(e,t,n){var r=d.isFunction(n)?n:d.parse(n);return this.optional(t)||r.call(this,e,t)},minlength:function(e,t,n){return this.optional(t)||this.getLen(e,t)>=n},maxlength:function(e,t,n){return this.optional(t)||this.getLen(e,t)<=n},rangelength:function(e,t,n){var r=this.getLen(e,t);return this.optional(t)||r>=n[0]&&r<=n[1]},min:function(e,t,n){return this.optional(t)||e>=n},max:function(e,t,n){return this.optional(t)||e<=n},range:function(e,t,n){return this.optional(t)||e>=n[0]&&e<=n[1]},numeric:function(e,t){return this.optional(t)||d.isNumeric(e)},digit:function(e,t){return this.optional(t)||d.isDigit(e)},prefix:function(e,t,n){return this.optional(t)||d.startsWith(e,n)},suffix:function(e,t,n){return this.optional(t)||d.endsWith(e,n)},equal:function(e,t,n){return this.optional(t)||e==n}},addMethod:function(e,t,n){d.isFunction(t)||d.error("method is not a function "+t),this.methods[e]=t,n&&(this.messages[e]=n)},patterns:{},addPattern:function(e,t,n){d.isRegExp(t)||d.error("argument is not a regular expression "+t);var r=this;r.patterns[e]=t,r.addMethod(e,function(t,n,i){return this.optional(n)||r.patterns[e].test(t)},n)},prototype:{init:function(e){this.settings=d.extend(!0,{},b.defaults,e),this.elementList=[],this.mismatch="dependency-mismatch",this.valids=new g,this.errors=new g},register:function(){var e=arguments[0],t=1,n=arguments.length,r=this.getKey(e),i=this.settings.rules,s=this.settings.messages,o;if(!r||n<2)return!1;for(;t<n;)if(o=arguments[t++])i[r]=d.extend(i[r],o.rules),s[r]=d.extend(s[r],i[r].messages,o.messages),delete i[r].messages;return d.isEmptyObject(i[r])?(delete i[r],delete s[r],!1):(d.inArray(this.elements(),e)==-1&&this.elementList.push(e),!0)},optional:function(e){return!this.constructor.methods.required.call(this,this.getValue(e),e)&&this.mismatch},getKey:y,getValue:y,getLen:y,numOfErrors:function(){return this.errors.len()},valid:function(){return this.numOfErrors()==0},reset:function(){this.valids.reset(),this.errors.reset()},elements:function(){return this.elementList},checkAll:function(){var e=0,t=this.elements(),n=t.length;this.reset();for(;e<n;)this.check(t[e++]);return this.valid()},check:function(e){var t,n,r,i,s=this.getKey(e),o=this.settings.rules[s];if(!s||e.disabled||d.isEmptyObject(o))return;for(t in o){r=o[t],i=this.constructor.methods[t],i||d.error("method "+t+" not found");try{n=i.call(this,this.getValue(e),e,r);if(n==this.mismatch)continue;if(!n)return this.formatAndAdd(e,t,r),!1}catch(u){d.error(u)}}return this.addResult(n,e)},addResult:function(e,t,n){return e===!1?(this.valids.remove(t),this.errors.add(t,n),e):(this.errors.remove(t),e==this.mismatch?(this.valids.remove(t),e):(this.valids.add(t),!0))},formatAndAdd:function(e,t,n){var r=this.defaultMessage(e,t);d.isFunction(r)?r=r.call(this,n):d.hasFormat(r)&&(r=d.format(r,n)),this.addResult(!1,e,r)},defaultMessage:function(e,t){var n=this.getKey(e);return this.customMessage(n,t)||e.title||this.constructor.messages[t]||"<strong>Warning: No message defined for "+n+"</strong>"},customMessage:function(e,t){var n=this.settings.messages[e];return n&&(d.isString(n)?n:n[t])}}}),d.extend(w,{appendNext:function(e,t){var n=this.attr(t).checkable,r=t.parentNode;do t=t.nextSibling;while(t&&n&&v.islabel(t));r.insertBefore(e,t)},findNext:function(e,t){do e=e.nextSibling;while(e&&(!v.isElement(e)||!this.isErrLabel(e,t)));return e},appendContainer:function(e,t){var r,i,s=n.body;do r=v.offset(t),i=t.offsetWidth;while(r.top==0&&(t=t.parentNode)&&t!==s);v.islabel(t.nextSibling)&&(i+=t.nextSibling.offsetWidth),e.style.top=r.top+"px",e.style.left=r.left+i+"px",this.settings.container.appendChild(e)},findContainer:function(e,t){var n;return d.each(this.settings.container.childNodes,function(e){if(this.isErrLabel(e,t))return n=e,!1},this),n},_parent:function(e){var t=this.attr(e);if(!t.offsetParent){var r=this.settings.findDepth||0,i=n.body;do e=e.parentNode;while(r-->0&&e&&e!==i);t.offsetParent=e}return t.offsetParent},findLast:function(e,t){var n=w._parent.call(this,e).lastChild;return this.isErrLabel(n,t)||(n=null),n},appendLast:function(e,t){w._parent.call(this,t).appendChild(e)},getListByKey:function(e){var t=d.isString(e)?e:this.getKey(e),n=[];return d.each(this.form.elements,function(e){this.isValElement(e)&&this.getKey(e)===t&&n.push(e)},this),n},parseAttr:function(){var e=/[a-z]\w+\s*,|[a-z]\w+\s*$/i,t=/^[^:,]+$/,n=/,\s*messages\s*:/i,r=/,\s*([a-z]\w+)/ig,i=/([a-z]\w+)\s*,/ig,s=/:(?:(?:\d|true):)*/g;return function(o){if(!d.isEmpty(o)){var u;return t.test(o)?o+=":1":e.test(o)&&(o=o.split(n),o[0]=o[0].replace(r,",$1:1").replace(i,"$1:1,").replace(s,":"),o=o.join(",messages:")),o.charAt(0)!="{"&&(o="{"+o+"}"),u=d.parse(o),u.rules||(u={rules:u}),u}}}(),ruleToAttr:function(e,t){var n=t.maxlength||t.rangelength;n&&(e.maxLength==-1||e.maxLength==2147483647)&&(d.isArray(n)&&(n=n[1]),e.maxLength=n)}}),d.extend(!0,w,b,{defaults:{ruleKey:"name",ruleAttr:"data-val",validCls:"valid",errorCls:"error",activeElCls:"fld-active",errorElCls:"fld-error",validElCls:"fld-valid",errorElement:"label",interceptInput:!0,interceptSubmit:!0,focusInvalid:!0,submitRandom:!0,highlight:function(e){this.elementCls(e,this.settings.errorElCls,this.settings.validElCls)},unhighlight:function(e){this.elementCls(e,this.settings.validElCls,this.settings.errorElCls)},labelText:function(e,t){e.innerHTML=t},showErrors:function(){this.errors.each(this.showLabel,this),this.valids.each(this.showLabel,this)},findLabel:w.findNext,appendLabel:w.appendNext},setDefaults:function(e){d.extend(w.defaults,e)}}),d.extend(!0,w.prototype,b.prototype,{initForm:function(){this.time=+(new Date),this.uuid=0,this.uukey="fancy_expando",this.attrMap={},d.each(this.form.elements,this.parseRule,this),this.elements().length?(this.hideErrors(),this.reset(),this.bindEvents()):this.debug("no elements want to validate")},isValElement:function(e){return v.isinput(e)||v.isselect(e)||v.istextarea(e)},getKey:function(e){var t=this.settings,n=t.ruleKeyAlter,r=t.getKey;return n&&v.attr(e,n)||r&&r.call(this,e)||v.attr(e,t.ruleKey)},getValue:function(e){return e.value},getLen:function(e,t){var n=0,r=this.attr(t);return r.checkable||r.multisel?(d.each(r.chklist||t,function(e){(e.checked||e.selected)&&n++}),n):d.trim(e).length},getElement:function(e){return this.form[e]||v.get(e)||$f.getListByKey.call(this,e)[0]},debug:function(){this.settings.debug&&v.log.apply(null,arguments)},checkForm:function(){var e=this.checkAll();return this.showErrors(),e},parseRule:function(e){if(!this.isValElement(e))return;var t=this.getKey(e),n=this.settings,r=d.trim(v.attr(e,n.ruleAttr));if(t&&this.register(e,w.parseAttr(r))){w.ruleToAttr(e,n.rules[t]);var i=this.attr(e);if(!i){var s=e[this.uukey]=t+this.uuid++;i=this.attrMap[s]={expando:s,key:t},this.defineAttr(e,i)}if(i.checkable&&e!=i.lastchk){var o=d.inArray(this.elements(),e);o>-1&&d.remove(this.elements(),o)}}},defineAttr:function(e,t){t.checkable=v.isIradio(e)||v.isIcheckbox(e),t.multisel=v.isselect(e)&&e.multiple===!0;if(t.checkable){var n=[],r=this.settings,i=this.uukey,s=r.getList&&r.getList.call(this,e)||this.getElement(e.name);s.length||(s=[s]),d.each(s,function(e){if(!e[i]||e[i]==t.expando)n.push(e),v.attr(e,r.ruleKey)||v.attr(e,r.ruleKey,t.key),e[i]=t.expando}),t.chklist=n,t.lastchk=n[n.length-1]}},attr:function(e){return this.attrMap[e[this.uukey]]},bindEvents:function(e){var t=m[e?"remove":"add"];this.settings.interceptInput&&d.each("focusin focusout input keyup click".split(" "),function(e){t(this.form,e,this.onInput())},this),this.settings.interceptSubmit&&t(this.form,"submit",this.onSubmit())},unload:function(){var e=this,t=this.uukey,n=this.settings.validElCls+" "+this.settings.errorElCls;d.each(this.elements(),function(r){e.elementCls(r,"",n),v.remove(e.errorsFor(r)),delete r[t]}),this.bindEvents(!0),this.reset(),this.attrMap={},this.uuid=0},onInput:function(){var e=this,t=this.settings;return function(n){var r,i,s,o=m.fix(n),u=o.target;v.isoption(u)&&(u=u.parentNode);if((v.isselect(u)||v.isIradio(u)||v.isIcheckbox(u))&&o.type!="click"&&o.type!="keyup")return;s=e.attr(u);if(s&&t.rules[s.key]){o.type=="focusin"||o.type=="focus"?v.addClass(u,t.activeElCls):(o.type=="focusout"||o.type=="blur")&&v.removeClass(u,t.activeElCls),r=e.getValue(u),i=e.getLen(r,u);if(s.prevVal!=r||s.prevLen!=i){s.prevVal=r,s.prevLen=i,s.checkable&&(u=s.lastchk);var a=e.errors.findEntry(u)||e.valids.findEntry(u);a&&e.hideLabel(a),e.check(u)===!0&&t.autoTab&&e.focusNext(u);var f=e.errors.findEntry(u)||e.valids.findEntry(u);f&&e.showLabel(f)}}}},onSubmit:function(){var e=this,t=this.settings;return function(n){var r=m.fix(n);if(!e.checkForm())return r.stop(),t.focusInvalid&&v.focus(e.errors.first()),!1;t.submitRandom&&e.addRandom(),t.beforeSubmit&&t.beforeSubmit.call(e,e.form,r);if(t.submitHandler)return r.stop(),t.submitHandler.call(e,e.form,r),!1}},addRandom:function(){var e=this;d.each({e:this.elements().length,d:+(new Date),t:this.time,r:Math.random()},function(t,r){var i=(e.getKey(this)||this.id)+"_"+r,s=e.getElement(i);s||(s=n.createElement("input"),s.type="hidden",this.insertBefore(s,this.firstChild)),s.name=i,s.value=t},this.form)},focusNext:function(e){var t=this.elements(),n=t.length,r=d.inArray(t,e)+1;r>0&&r<n&&v.focus(t[r])},showErrors:function(){this.settings.showErrors.call(this)},showLabel:function(e){var t=this.errorsFor(e.key),n=this.settings;v.removeClass(t,n.validCls),v.addClass(t,n.errorCls),n.labelText.call(this,t,e.message),(e.message||n.validCls)&&v.toggle(t,!0),e.message?n.highlight.call(this,e.key):(n.unhighlight.call(this,e.key),v.addClass(t,n.validCls))},hideLabel:function(e){v.toggle(this.errorsFor(e.key))},hideErrors:function(){var e=this;d.each(this.elements(),function(t){v.toggle(e.errorsFor(t),!1)})},elementCls:function(e,t,n){var r=this.attr(e);r.checkable?d.each(r.chklist,function(e){v.removeClass(e,n),v.addClass(e,t)}):(v.removeClass(e,n),v.addClass(e,t))},errorsFor:function(e){var t=this.attr(e),r=t.errLabel;if(!r){var i=this.settings,s=e.id||t.key,o=this.uukey+"_for";r=i.findLabel.call(this,e,s);if(!r||r[o]&&r[o]!=expando)r=n.createElement(i.errorElement),v.attr(r,"for",s),v.attr(r,"fancy",s),i.appendLabel.call(this,r,e),t.errLabel=r,r[o]=t.expando}return r},isErrLabel:function(e,t){return v.attr(e,"for")==t&&v.attr(e,"fancy")==t}}),w.base=b,e.fancy=e.$f=w})(window);